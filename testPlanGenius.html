<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>TestPlan Genius - ìš”êµ¬ì‚¬í•­ ê¸°ë°˜ í…ŒìŠ¤íŠ¸ í”Œëœ ìë™ ìƒì„± (HTML ë²„ì „)</title>
  <!-- Bootstrap 5 CSS -->
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
    rel="stylesheet"
  />
  <!-- html2pdf.js for HTML -> PDF -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
  <style>
    body {
      background-color: #f4f6fb;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }
    .tp-sidebar {
      background: #0b1f3b;
      color: #fff;
      min-height: 100vh;
    }
    .tp-logo {
      font-weight: 700;
      font-size: 1.25rem;
      margin-bottom: 1rem;
    }
    .tp-step-item {
      padding: 0.4rem 0.2rem;
      opacity: 0.7;
      border-left: 3px solid transparent;
      cursor: pointer;
    }
    .tp-step-item.active {
      opacity: 1;
      border-left-color: #1abc9c;
      padding-left: 0.5rem;
      font-weight: 600;
    }
    .tp-card {
      background: #ffffff;
      border-radius: 0.75rem;
      padding: 1rem 1.3rem;
      margin-bottom: 1rem;
      box-shadow: 0 4px 10px rgba(15, 23, 42, 0.06);
    }
    .chip {
      border-radius: 999px;
      border: 1px solid #dee2e6;
      background: #f8f9fa;
      padding: 0.15rem 0.75rem;
      font-size: 0.8rem;
      margin-right: 0.25rem;
      margin-bottom: 0.25rem;
      cursor: pointer;
    }
    .chip-active {
      background: #1abc9c;
      color: white;
      border-color: #1abc9c;
    }

    /* ë¬¸ì„œ ì˜ì—­ ìŠ¤íƒ€ì¼ (HTML ì¶œë ¥ìš©) */
    .tp-doc {
      background: #ffffff;
      padding: 24px 32px;
      border-radius: 0.75rem;
      box-shadow: 0 4px 10px rgba(15, 23, 42, 0.08);
      color: #111827;
      font-size: 0.95rem;
      line-height: 1.6;
    }
    .tp-doc h1 {
      font-size: 1.5rem;
      font-weight: 700;
      margin-bottom: 0.25rem;
    }
    .tp-doc h2 {
      font-size: 1.2rem;
      font-weight: 600;
      margin-top: 1.5rem;
      margin-bottom: 0.5rem;
      border-bottom: 1px solid #e5e7eb;
      padding-bottom: 0.25rem;
    }
    .tp-doc h3 {
      font-size: 1rem;
      font-weight: 600;
      margin-top: 1rem;
      margin-bottom: 0.35rem;
    }
    .tp-doc small {
      color: #6b7280;
    }
    .tp-doc .meta {
      margin-bottom: 1rem;
      font-size: 0.9rem;
    }
    .tp-doc table {
      width: 100%;
      border-collapse: collapse;
      margin: 0.5rem 0 1rem 0;
      font-size: 0.9rem;
    }
    .tp-doc table th,
    .tp-doc table td {
      border: 1px solid #e5e7eb;
      padding: 0.35rem 0.5rem;
      vertical-align: top;
    }
    .tp-doc table th {
      background: #f9fafb;
      font-weight: 600;
      text-align: left;
    }
    .tp-doc ul {
      margin-bottom: 0.5rem;
    }
    .tp-doc-section-number {
      font-weight: 700;
      margin-right: 0.15rem;
    }

    /* PDFìš© ìˆ¨ê²¨ì§„ ì˜ì—­ (Export ì‹œ ì‚¬ìš©) */
    #planExportWrapper {
      position: fixed;
      left: -9999px;
      top: -9999px;
      width: 210mm;
      /* PDF A4 í­ ê¸°ì¤€ */
    }
  </style>
</head>
<body>
  <div class="container-fluid">
    <div class="row">
      <!-- ì‚¬ì´ë“œë°” -->
      <div class="col-12 col-md-3 col-lg-2 tp-sidebar p-3">
        <div class="tp-logo">TestPlan Genius</div>
        <div class="small mb-3">ìš”êµ¬ì‚¬í•­ ê¸°ë°˜ í…ŒìŠ¤íŠ¸ í”Œëœ ìë™ ìƒì„± (HTML)</div>
        <div id="step1Nav" class="tp-step-item active" onclick="goToStep(1)">
          1. Project & Requirements
        </div>
        <div id="step2Nav" class="tp-step-item" onclick="goToStep(2)">
          2. Strategy
        </div>
        <div id="step3Nav" class="tp-step-item" onclick="goToStep(3)">
          3. Generate & Preview
        </div>
        <div id="step4Nav" class="tp-step-item" onclick="goToStep(4)">
          4. Export
        </div>
      </div>

      <!-- ë©”ì¸ ì˜ì—­ -->
      <div class="col-12 col-md-9 col-lg-10 p-4">
        <header class="mb-3">
          <h2 class="mb-0">TestPlan Genius (HTML & PDF)</h2>
          <p class="text-muted mb-0">
            ìš”êµ¬ì‚¬í•­ê³¼ í…ŒìŠ¤íŠ¸ ì „ëµì„ ì…ë ¥í•˜ë©´ HTML ê¸°ë°˜ í…ŒìŠ¤íŠ¸ í”Œëœ ë¬¸ì„œë¥¼ ìƒì„±í•˜ê³ , ê·¸ëŒ€ë¡œ PDFë¡œ ë‹¤ìš´ë¡œë“œí•©ë‹ˆë‹¤.
          </p>
        </header>

        <!-- Step 1 -->
        <section id="step1" class="step-section">
          <div class="tp-card">
            <h4 class="mb-3">Step 1. í”„ë¡œì íŠ¸ ê¸°ë³¸ ì •ë³´</h4>
            <div class="row g-3">
              <div class="col-md-6">
                <label class="form-label">í”„ë¡œì íŠ¸ ì´ë¦„</label>
                <input id="projectName" type="text" class="form-control" placeholder="ì˜ˆ: ì˜¨ë¼ì¸ ì‡¼í•‘ëª°" />
              </div>
              <div class="col-md-3">
                <label class="form-label">ë²„ì „</label>
                <input id="projectVersion" type="text" class="form-control" value="1.0" />
              </div>
              <div class="col-md-3">
                <label class="form-label">í…ŒìŠ¤íŠ¸ ë¦¬ë”</label>
                <input id="testLeader" type="text" class="form-control" placeholder="í™ê¸¸ë™" />
              </div>
              <div class="col-md-4">
                <label class="form-label">ìŠ¤í°ì„œ/ê³ ê°</label>
                <input id="sponsor" type="text" class="form-control" placeholder="ê³ ê°ì‚¬ ì´ë¦„" />
              </div>
              <div class="col-md-4">
                <label class="form-label">ë¦´ë¦¬ì¦ˆ ëª©í‘œì¼</label>
                <input id="releaseDate" type="date" class="form-control" />
              </div>
              <div class="col-md-4"></div>
              <div class="col-md-4">
                <label class="form-label">í…ŒìŠ¤íŠ¸ ì‹œì‘ì¼</label>
                <input id="testStartDate" type="date" class="form-control" />
              </div>
              <div class="col-md-4">
                <label class="form-label">í…ŒìŠ¤íŠ¸ ì¢…ë£Œì¼</label>
                <input id="testEndDate" type="date" class="form-control" />
              </div>
            </div>
          </div>

          <div class="tp-card">
            <h4 class="mb-3">Step 1. ìš”êµ¬ì‚¬í•­ ì…ë ¥</h4>
            <p class="small text-muted mb-2">
              FR/NFR, ìš°ì„ ìˆœìœ„, í…ŒìŠ¤íŠ¸ íƒ€ì… íƒœê·¸ë¥¼ ê°„ë‹¨íˆ ì…ë ¥í•˜ì„¸ìš”.
            </p>
            <div class="table-responsive">
              <table class="table align-middle table-sm">
                <thead class="table-light">
                  <tr>
                    <th style="width: 10%">ID</th>
                    <th style="width: 10%">ìœ í˜•</th>
                    <th style="width: 40%">ì„¤ëª…</th>
                    <th style="width: 15%">ìš°ì„ ìˆœìœ„</th>
                    <th style="width: 20%">í…ŒìŠ¤íŠ¸ íƒ€ì… íƒœê·¸</th>
                    <th style="width: 5%"></th>
                  </tr>
                </thead>
                <tbody id="requirementsBody">
                  <!-- ê¸°ë³¸ í•œ ì¤„ì€ JSì—ì„œ ì¶”ê°€ -->
                </tbody>
              </table>
            </div>
            <button class="btn btn-outline-secondary btn-sm" onclick="addRequirementRow()">
              + ìš”êµ¬ì‚¬í•­ í–‰ ì¶”ê°€
            </button>
          </div>

          <div class="d-flex justify-content-end">
            <button class="btn btn-success" onclick="goToStep(2)">ë‹¤ìŒ ë‹¨ê³„ë¡œ</button>
          </div>
        </section>

        <!-- Step 2 -->
        <section id="step2" class="step-section d-none">
          <div class="tp-card">
            <h4 class="mb-3">Step 2. í…ŒìŠ¤íŠ¸ ì „ëµ ì„¤ì •</h4>
            <div class="mb-3">
              <label class="form-label">í…ŒìŠ¤íŠ¸ ë ˆë²¨</label>
              <div id="levelChips"></div>
              <div class="form-text">Unit / Integration / System / Acceptance ì¤‘ ì„ íƒ</div>
            </div>

            <div class="mb-3">
              <label class="form-label">í…ŒìŠ¤íŠ¸ ìœ í˜•</label>
              <div id="typeChips"></div>
              <div class="form-text">Function / Regression / Performance / Security / Usability</div>
            </div>

            <div class="mb-3">
              <label class="form-label">ìë™í™” ë¹„ìœ¨: <span id="automationLabel">30%</span></label>
              <input
                id="automationRate"
                type="range"
                class="form-range"
                min="0"
                max="100"
                value="30"
                oninput="document.getElementById('automationLabel').innerText=this.value+'%'"
              />
            </div>

            <div class="mb-3">
              <label class="form-label">ì‚¬ìš© ë„êµ¬ (ì½¤ë§ˆë¡œ êµ¬ë¶„)</label>
              <input
                id="tools"
                type="text"
                class="form-control"
                placeholder="ì˜ˆ: JUnit, Cypress, JMeter"
              />
            </div>
          </div>

          <div class="d-flex justify-content-between">
            <button class="btn btn-outline-secondary" onclick="goToStep(1)">ì´ì „</button>
            <button class="btn btn-success" onclick="goToStep(3)">ë‹¤ìŒ ë‹¨ê³„ë¡œ</button>
          </div>
        </section>

        <!-- Step 3 -->
        <section id="step3" class="step-section d-none">
          <div class="tp-card mb-3">
            <h4 class="mb-3">Step 3. í”Œëœ ìƒì„± ë° ë¯¸ë¦¬ë³´ê¸°</h4>
            <p class="small text-muted mb-2">
              ì§€ê¸ˆê¹Œì§€ ì…ë ¥í•œ ë‚´ìš©ì„ ë°”íƒ•ìœ¼ë¡œ HTML í…ŒìŠ¤íŠ¸ í”Œëœ ë¬¸ì„œë¥¼ ìƒì„±í•©ë‹ˆë‹¤.
            </p>
            <button class="btn btn-primary mb-3" onclick="generatePlan()">
              Generate Test Plan (HTML)
            </button>
          </div>

          <div id="previewWrapper" class="tp-card d-none">
            <h5 class="mb-3">ë¯¸ë¦¬ë³´ê¸°</h5>
            <div id="planPreview" class="tp-doc"></div>
          </div>

          <div class="d-flex justify-content-between mt-3">
            <button class="btn btn-outline-secondary" onclick="goToStep(2)">ì´ì „</button>
            <button class="btn btn-success" onclick="goToStep(4)">Export ë‹¨ê³„ë¡œ</button>
          </div>
        </section>

        <!-- Step 4 -->
        <section id="step4" class="step-section d-none">
          <div class="tp-card mb-3">
            <h4 class="mb-3">Step 4. Export</h4>
            <p class="small text-muted">
              ì•„ë˜ HTML ë¬¸ì„œë¥¼ ê·¸ëŒ€ë¡œ PDFë¡œ ì €ì¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
            </p>
          </div>
          <div class="tp-card">
            <div id="planPreviewExport" class="tp-doc"></div>
          </div>
          <div class="d-flex gap-2 mt-3">
            <button class="btn btn-outline-secondary" onclick="goToStep(3)">
              ë¯¸ë¦¬ë³´ê¸°ë¡œ ëŒì•„ê°€ê¸°
            </button>
            <button class="btn btn-outline-dark" onclick="downloadPDF()">
              PDF ë‹¤ìš´ë¡œë“œ
            </button>
          </div>
        </section>
      </div>
    </div>
  </div>

  <!-- PDFìš© ìˆ¨ê²¨ì§„ ì˜ì—­ -->
  <div id="planExportWrapper">
    <div id="planExport" class="tp-doc"></div>
  </div>

  <!-- Bootstrap JS (ì˜µì…˜) -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    // ---------- Step ì „í™˜ ----------
    function goToStep(step) {
      for (let i = 1; i <= 4; i++) {
        document.getElementById("step" + i).classList.add("d-none");
        document.getElementById("step" + i + "Nav").classList.remove("active");
      }
      document.getElementById("step" + step).classList.remove("d-none");
      document.getElementById("step" + step + "Nav").classList.add("active");

      // Export ë‹¨ê³„ë¡œ ê°ˆ ë•Œ í˜„ì¬ HTML ë™ê¸°í™”
      if (step === 4) {
        const html = document.getElementById("planPreview").innerHTML;
        document.getElementById("planPreviewExport").innerHTML = html;
        document.getElementById("planExport").innerHTML = html; // PDFìš© ìˆ¨ê¹€ ì˜ì—­
      }
    }

    // ---------- ìš”êµ¬ì‚¬í•­ í–‰ ê´€ë¦¬ ----------
    function addRequirementRow(defaultData) {
      const tbody = document.getElementById("requirementsBody");
      const row = document.createElement("tr");

      const idx = tbody.rows.length + 1;
      const reqId = defaultData?.reqId || "FR-00" + idx;
      const type = defaultData?.type || "FR";
      const desc = defaultData?.description || "";
      const priority = defaultData?.priority || "High";
      const tags = (defaultData?.tags || []).join(", ");

      row.innerHTML = `
        <td><input class="form-control form-control-sm req-id" value="${reqId}" /></td>
        <td>
          <select class="form-select form-select-sm req-type">
            <option value="FR" ${type === "FR" ? "selected" : ""}>FR</option>
            <option value="NFR" ${type === "NFR" ? "selected" : ""}>NFR</option>
          </select>
        </td>
        <td><input class="form-control form-control-sm req-desc" value="${desc}" placeholder="ì˜ˆ: ë¡œê·¸ì¸ ê¸°ëŠ¥, ì‘ë‹µì‹œê°„ 3ì´ˆ ì´ë‚´ ë“±" /></td>
        <td>
          <select class="form-select form-select-sm req-priority">
            <option value="High" ${priority === "High" ? "selected" : ""}>High</option>
            <option value="Medium" ${priority === "Medium" ? "selected" : ""}>Medium</option>
            <option value="Low" ${priority === "Low" ? "selected" : ""}>Low</option>
          </select>
        </td>
        <td>
          <input class="form-control form-control-sm req-tags" value="${tags}" placeholder="ê¸°ëŠ¥, ë³´ì•ˆ, ì„±ëŠ¥ ë“±" />
        </td>
        <td>
          <button class="btn btn-outline-danger btn-sm" onclick="this.closest('tr').remove()">X</button>
        </td>
      `;

      tbody.appendChild(row);
    }

    // ---------- ì „ëµ chips ----------
    const LEVELS = ["Unit", "Integration", "System", "Acceptance"];
    const TYPES = ["Function", "Regression", "Performance", "Security", "Usability"];

    function createChips() {
      const levelContainer = document.getElementById("levelChips");
      LEVELS.forEach((lvl) => {
        const span = document.createElement("span");
        span.className = "chip";
        span.innerText = lvl;
        span.onclick = function () {
          span.classList.toggle("chip-active");
        };
        levelContainer.appendChild(span);
      });

      const typeContainer = document.getElementById("typeChips");
      TYPES.forEach((t) => {
        const span = document.createElement("span");
        span.className = "chip";
        span.innerText = t;
        span.onclick = function () {
          span.classList.toggle("chip-active");
        };
        typeContainer.appendChild(span);
      });
    }

    // ---------- ë°ì´í„° ìˆ˜ì§‘ ----------
    function getProjectData() {
      return {
        name: document.getElementById("projectName").value || "Untitled Project",
        version: document.getElementById("projectVersion").value || "1.0",
        testLeader: document.getElementById("testLeader").value || "",
        sponsor: document.getElementById("sponsor").value || "",
        releaseDate: document.getElementById("releaseDate").value || "",
        testStartDate: document.getElementById("testStartDate").value || "",
        testEndDate: document.getElementById("testEndDate").value || "",
      };
    }

    function getRequirements() {
      const rows = document.querySelectorAll("#requirementsBody tr");
      const list = [];
      rows.forEach((row) => {
        const reqId = row.querySelector(".req-id").value.trim();
        const type = row.querySelector(".req-type").value;
        const desc = row.querySelector(".req-desc").value.trim();
        const priority = row.querySelector(".req-priority").value;
        const tags = row
          .querySelector(".req-tags")
          .value.split(",")
          .map((t) => t.trim())
          .filter(Boolean);
        if (reqId || desc) {
          list.push({ reqId, type, description: desc, priority, tags });
        }
      });
      return list;
    }

    function getStrategy() {
      const levels = [];
      document.querySelectorAll("#levelChips .chip-active").forEach((el) => {
        levels.push(el.innerText);
      });
      const types = [];
      document.querySelectorAll("#typeChips .chip-active").forEach((el) => {
        types.push(el.innerText);
      });
      const automationRate = Number(document.getElementById("automationRate").value) || 0;
      const tools = document
        .getElementById("tools")
        .value.split(",")
        .map((t) => t.trim())
        .filter(Boolean);

      return { levels, types, automationRate, tools };
    }

    // ---------- HTML ë¬¸ì„œ ìƒì„± ----------
    function generateTestPlanHTML(project, requirements, strategy) {
      const {
        name,
        version,
        testLeader,
        sponsor,
        releaseDate,
        testStartDate,
        testEndDate,
      } = project;

      const createdDate = new Date().toISOString().slice(0, 10);
      const levels = (strategy.levels || []).join(", ") || "N/A";
      const types = (strategy.types || []).join(", ") || "N/A";
      const automationRate = strategy.automationRate ?? 0;
      const tools = (strategy.tools || []).join(", ") || "-";

      const rtmRows =
        requirements.length > 0
          ? requirements
              .map((r) => {
                const typeTags = r.tags && r.tags.length > 0 ? r.tags.join(", ") : "";
                return `
                <tr>
                  <td>${r.reqId}</td>
                  <td>${r.description}</td>
                  <td>${r.priority || ""}</td>
                  <td>${typeTags}</td>
                </tr>`;
              })
              .join("")
          : `
          <tr>
            <td colspan="4">ì •ì˜ëœ ìš”êµ¬ì‚¬í•­ì´ ì—†ìŠµë‹ˆë‹¤.</td>
          </tr>`;

      return `
        <div>
          <h1>ğŸ“„ ${name} - í…ŒìŠ¤íŠ¸ í”Œëœ (Test Plan)</h1>
          <div class="meta">
            <div><strong>ë¬¸ì„œ ë²„ì „:</strong> ${version}</div>
            <div><strong>ì‘ì„±ì¼:</strong> ${createdDate}</div>
            <div><strong>ì‘ì„±ì:</strong> ${testLeader || "-"}</div>
            <div><strong>ìŠ¤í°ì„œ/ê³ ê°:</strong> ${sponsor || "-"}</div>
          </div>

          <h2><span class="tp-doc-section-number">1.</span> ê°œìš” (Introduction)</h2>
          <p>
            ì´ ë¬¸ì„œëŠ” <strong>${name}</strong> í”„ë¡œì íŠ¸ì˜ ì†Œí”„íŠ¸ì›¨ì–´ í’ˆì§ˆ ë³´ì¦ì„ ìœ„í•œ í…ŒìŠ¤íŠ¸ í™œë™ì„ ì •ì˜í•œë‹¤.
          </p>
          <h3>1.1 í…ŒìŠ¤íŠ¸ ëª©í‘œ</h3>
          <ul>
            <li>í•µì‹¬ ê¸°ëŠ¥ì  ìš”êµ¬ì‚¬í•­ì´ ì •ìƒì ìœ¼ë¡œ ë™ì‘í•˜ëŠ”ì§€ ê²€ì¦í•œë‹¤.</li>
            <li>ì£¼ìš” ë¹„ê¸°ëŠ¥ ìš”êµ¬ì‚¬í•­(ì„±ëŠ¥, ë³´ì•ˆ ë“±)ì„ ê²€ì¦í•œë‹¤.</li>
            <li>ë¦´ë¦¬ì¦ˆ ì „ ì ì¬ì ì¸ ê²°í•¨ê³¼ ìœ„í—˜ì„ ìµœì†Œí™”í•œë‹¤.</li>
          </ul>
          <h3>1.2 í…ŒìŠ¤íŠ¸ ë²”ìœ„ (Scope)</h3>
          <ul>
            <li><strong>í¬í•¨ ëŒ€ìƒ:</strong> ìš”êµ¬ì‚¬í•­ ëª…ì„¸ì„œì— ì •ì˜ëœ ì£¼ìš” ê¸°ëŠ¥ ëª¨ë“ˆ ë° ì„œë¹„ìŠ¤.</li>
            <li><strong>ì œì™¸ ëŒ€ìƒ:</strong> í˜„ì¬ ë¦´ë¦¬ì¦ˆ ë²”ìœ„ì—ì„œ ì œì™¸ëœ ê¸°ëŠ¥ ë˜ëŠ” ìš°ì„ ìˆœìœ„ê°€ ë‚®ì€ í•­ëª©.</li>
          </ul>

          <h2><span class="tp-doc-section-number">2.</span> í…ŒìŠ¤íŠ¸ ì „ëµ ë° ì ‘ê·¼ ë°©ì‹ (Strategy)</h2>
          <table>
            <thead>
              <tr>
                <th>êµ¬ë¶„</th>
                <th>ì ìš© ì—¬ë¶€</th>
                <th>ì„¤ëª…</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>í…ŒìŠ¤íŠ¸ ë ˆë²¨</td>
                <td>${levels}</td>
                <td>ì„ íƒëœ í…ŒìŠ¤íŠ¸ ë ˆë²¨ì„ ì¤‘ì‹¬ìœ¼ë¡œ ë‹¨ê³„ë³„ë¡œ í…ŒìŠ¤íŠ¸ë¥¼ ìˆ˜í–‰í•œë‹¤.</td>
              </tr>
              <tr>
                <td>í•µì‹¬ í…ŒìŠ¤íŠ¸ ìœ í˜•</td>
                <td>${types}</td>
                <td>ê¸°ëŠ¥ íšŒê·€ ë° í•µì‹¬ ë¹„ê¸°ëŠ¥ ìš”êµ¬ì‚¬í•­ì— ëŒ€í•œ ê²€ì¦ì„ ìˆ˜í–‰í•œë‹¤.</td>
              </tr>
              <tr>
                <td>ìë™í™” ëª©í‘œ</td>
                <td>${automationRate}%</td>
                <td>ìë™í™” í…ŒìŠ¤íŠ¸ë¥¼ í†µí•´ ë°˜ë³µ ì‘ì—…ì„ ìµœì†Œí™”í•˜ê³  íšŒê·€ ê²€ì¦ íš¨ìœ¨ì„ ë†’ì¸ë‹¤.</td>
              </tr>
            </tbody>
          </table>
          <p><strong>ì‚¬ìš©í•  ì£¼ìš” í…ŒìŠ¤íŠ¸ ë„êµ¬:</strong> ${tools}</p>

          <h2><span class="tp-doc-section-number">3.</span> í…ŒìŠ¤íŠ¸ í•­ëª© (Items to be Tested)</h2>
          <p><strong>ìš”êµ¬ì‚¬í•­ ì¶”ì ì„± ë§¤íŠ¸ë¦­ìŠ¤ (RTM) ìš”ì•½</strong></p>
          <table>
            <thead>
              <tr>
                <th>ìš”êµ¬ì‚¬í•­ ID</th>
                <th>ê¸°ëŠ¥/ì„¤ëª…</th>
                <th>ìš°ì„ ìˆœìœ„</th>
                <th>í…ŒìŠ¤íŠ¸ íƒ€ì…</th>
              </tr>
            </thead>
            <tbody>
              ${rtmRows}
            </tbody>
          </table>

          <h2><span class="tp-doc-section-number">4.</span> í…ŒìŠ¤íŠ¸ í™˜ê²½ (Environment)</h2>
          <ul>
            <li><strong>í•˜ë“œì›¨ì–´ êµ¬ì„±:</strong> ì„œë²„ ë° í´ë¼ì´ì–¸íŠ¸ í™˜ê²½ì€ í”„ë¡œì íŠ¸ ì¸í”„ë¼ ì„¤ê³„ ë¬¸ì„œë¥¼ ë”°ë¥¸ë‹¤.</li>
            <li><strong>ì†Œí”„íŠ¸ì›¨ì–´ êµ¬ì„±:</strong> ìš´ì˜ì²´ì œ, DBMS, ì›¹ ì„œë²„ ë° ë¯¸ë“¤ì›¨ì–´ ë²„ì „ì€ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜ ë¬¸ì„œì— ëª…ì‹œëœ êµ¬ì„±ì„ ë”°ë¥¸ë‹¤.</li>
            <li><strong>í…ŒìŠ¤íŠ¸ ë°ì´í„°:</strong> ëŒ€í‘œ ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ì¶©ë¶„íˆ ì»¤ë²„í•  ìˆ˜ ìˆë„ë¡ ìµëª… ì²˜ë¦¬ëœ ì‹¤ì œ ë°ì´í„° ìƒ˜í”Œê³¼ í…ŒìŠ¤íŠ¸ ì „ìš© ë°ì´í„°ë¥¼ í•¨ê»˜ ì‚¬ìš©í•œë‹¤.</li>
          </ul>

          <h2><span class="tp-doc-section-number">5.</span> ì¼ì • ë° ìì› ê³„íš (Schedule & Resources)</h2>
          <ul>
            <li><strong>ë¦´ë¦¬ì¦ˆ ëª©í‘œì¼:</strong> ${releaseDate || "-"}</li>
            <li><strong>í…ŒìŠ¤íŠ¸ ì‹œì‘ì¼:</strong> ${testStartDate || "-"}</li>
            <li><strong>í…ŒìŠ¤íŠ¸ ì¢…ë£Œì¼:</strong> ${testEndDate || "-"}</li>
          </ul>
          <p>
            í…ŒìŠ¤íŠ¸ëŠ” ë‹¨ìœ„ í…ŒìŠ¤íŠ¸(Unit), í†µí•© í…ŒìŠ¤íŠ¸(Integration), ì‹œìŠ¤í…œ í…ŒìŠ¤íŠ¸(System), ì¸ìˆ˜ í…ŒìŠ¤íŠ¸(Acceptance)ì˜
            ë‹¨ê³„ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ê³„íšë˜ë©°, ê° ë‹¨ê³„ë³„ ì™„ë£Œ ê¸°ì¤€ê³¼ ë§ˆì¼ìŠ¤í†¤ì„ ë³„ë„ ì¼ì •í‘œë¡œ ê´€ë¦¬í•œë‹¤.
          </p>
          <p>
            QA ì—”ì§€ë‹ˆì–´, ìë™í™” ì „ë¬¸ê°€, ë„ë©”ì¸ ì „ë¬¸ê°€ ë“± í•„ìš”í•œ ì—­í• ì„ ì •ì˜í•˜ê³ , ê° ì—­í• ë³„ ì±…ì„ê³¼ íˆ¬ì… ê¸°ê°„ì„ ëª…ì‹œí•œë‹¤.
          </p>

          <!-- 6. ìœ„í—˜ ê´€ë¦¬ ì„¹ì…˜ì€ ìš”ì²­ì— ë”°ë¼ ì œê±° -->

          <h2><span class="tp-doc-section-number">6.</span> í…ŒìŠ¤íŠ¸ í”„ë¡œì„¸ìŠ¤ ë° ì ˆì°¨ (Test Process & Procedures)</h2>
          <ol>
            <li>ìš”êµ¬ì‚¬í•­ ë¶„ì„</li>
            <li>í…ŒìŠ¤íŠ¸ ì„¤ê³„ ë° ì¼€ì´ìŠ¤ ì •ì˜</li>
            <li>í…ŒìŠ¤íŠ¸ ë°ì´í„° ì¤€ë¹„</li>
            <li>í…ŒìŠ¤íŠ¸ ìˆ˜í–‰ ë° ê²°ê³¼ ê¸°ë¡</li>
            <li>ê²°í•¨ ë“±ë¡ ë° ì¶”ì </li>
            <li>íšŒê·€ í…ŒìŠ¤íŠ¸ ë° ìµœì¢… ë¦¬í¬íŠ¸ ì‘ì„±</li>
          </ol>

          <h2><span class="tp-doc-section-number">7.</span> ê²°í•¨ ê´€ë¦¬ (Defect Management)</h2>
          <ul>
            <li>ê²°í•¨ì€ ì‹¬ê°ë„(Sev1~Sev4)ì™€ ìš°ì„ ìˆœìœ„(P1~P4)ë¡œ ë¶„ë¥˜í•œë‹¤.</li>
            <li>ê²°í•¨ ìƒíƒœëŠ” New â†’ Assigned â†’ Fixed â†’ Verified â†’ Closed íë¦„ìœ¼ë¡œ ê´€ë¦¬í•œë‹¤.</li>
            <li>ì´ìŠˆ íŠ¸ë˜í‚¹ ë„êµ¬(Jira, Redmine ë“±)ë¥¼ ì‚¬ìš©í•˜ì—¬ ê²°í•¨ ì´ë ¥ê³¼ ë³€ê²½ ë‚´ì—­ì„ ê´€ë¦¬í•œë‹¤.</li>
          </ul>

          <h2><span class="tp-doc-section-number">8.</span> ìŠ¹ì¸ ë° ë³€ê²½ ê´€ë¦¬ (Approval & Change Management)</h2>
          <ul>
            <li>í…ŒìŠ¤íŠ¸ í”Œëœ ë° ë²”ìœ„ ë³€ê²½ì€ ë³€ê²½ ìš”ì²­ì„œì™€ ì˜í–¥ë„ ë¶„ì„ì„ í†µí•´ ìŠ¹ì¸ ì ˆì°¨ë¥¼ ê±°ì¹œë‹¤.</li>
            <li>í”„ë¡œì íŠ¸ ë§¤ë‹ˆì €, QA ë¦¬ë”, ê°œë°œ ë¦¬ë” ë“± ì£¼ìš” ì´í•´ê´€ê³„ìì˜ ìŠ¹ì¸ì„ ê¸°ë¡í•œë‹¤.</li>
          </ul>

          <h2><span class="tp-doc-section-number">9.</span> ë¶€ë¡ (Appendix)</h2>
          <ul>
            <li>ìš©ì–´ ì •ì˜(Glossary)</li>
            <li>ì°¸ì¡° ë¬¸ì„œ ëª©ë¡ (ìš”êµ¬ì‚¬í•­ ëª…ì„¸ì„œ, ì„¤ê³„ì„œ, ì•„í‚¤í…ì²˜ ë¬¸ì„œ ë“±)</li>
          </ul>
        </div>
      `;
    }

    // ---------- Generate ë²„íŠ¼ ----------
    function generatePlan() {
      const project = getProjectData();
      const requirements = getRequirements();
      const strategy = getStrategy();

      const html = generateTestPlanHTML(project, requirements, strategy);

      const preview = document.getElementById("planPreview");
      preview.innerHTML = html;
      document.getElementById("previewWrapper").classList.remove("d-none");
    }

    // ---------- HTML â†’ PDF ë‹¤ìš´ë¡œë“œ ----------
    function downloadPDF() {
      const projectName = document.getElementById("projectName").value || "testplan";
      const element = document.getElementById("planExport"); // ìˆ¨ê²¨ì§„ ìˆœìˆ˜ ë¬¸ì„œ ì˜ì—­

      const opt = {
        margin: 10,
        filename: projectName + "_testplan.pdf",
        html2canvas: { scale: 2, useCORS: true },
        jsPDF: { unit: "mm", format: "a4", orientation: "portrait" },
      };

      html2pdf().set(opt).from(element).save();
    }

    // ---------- ì´ˆê¸° ì„¸íŒ… ----------
    function init() {
      createChips();
      addRequirementRow({
        reqId: "FR-001",
        type: "FR",
        description: "ì‚¬ìš©ì ë¡œê·¸ì¸ ê¸°ëŠ¥ ì œê³µ",
        priority: "High",
        tags: ["ê¸°ëŠ¥", "ë³´ì•ˆ"],
      });
    }

    document.addEventListener("DOMContentLoaded", init);
  </script>
</body>
</html>
